using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Numerics;
using System.Threading;
using System.Threading.Tasks;

using Nethereum.Geth;
using Nethereum.Web3;
using Nethereum.Web3.Accounts;
using Nethereum.Web3.Accounts.Managed;
using Nethereum.Contracts;
using Nethereum.Hex.HexTypes;
using Nethereum.Hex.HexConvertors.Extensions;
using Nethereum.RPC.Eth;
using Nethereum.RPC.Eth.DTOs;
using Nethereum.RPC.Eth.Filters;
using Nethereum.ABI.FunctionEncoding.Attributes;

using Nethereum.ABI.FunctionEncoding;
using Nethereum.ABI.Model;
using Nethereum.JsonRpc.Client;

using Nethereum.ABI.Encoders;

using FDBC_Nethereum.DotNetWeb3Geth;
using Newtonsoft.Json;


namespace FDBC_Nethereum.SmartContracts
{
  public class Policy
  {
    private readonly Web3Geth _web3geth;
    private readonly string _default_sender_address;
    private readonly string _default_sender_password;
    private readonly string _test_existing_contract_address;
    private readonly string _contract_abi;
    private readonly string _contract_bytecode;

    public Policy(Web3Geth web3geth)
    {
      _web3geth = web3geth;
      _default_sender_address = "0x6376612e86c6f0be774cfa62e0eb732f87352115";
      _default_sender_password = "123";
      _test_existing_contract_address = "0x9d851e4e6644e000fa6d57880812eaf5a76e93d5";
      _contract_abi = @"[{'constant':false,'inputs':[],'name':'PostInit','outputs':[],'payable':false,'type':'function'},{'constant':false,'inputs':[{'name':'task_uuid','type':'string'},{'name':'input','type':'string'}],'name':'set_deleted','outputs':[],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'start_date_time_local','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'status','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'start_date_time','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'constant':false,'inputs':[{'name':'task_uuid','type':'string'},{'name':'input','type':'string'}],'name':'set_status','outputs':[],'payable':false,'type':'function'},{'constant':false,'inputs':[{'name':'task_uuid','type':'string'},{'name':'input','type':'string'}],'name':'set_start_date_time_local','outputs':[],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'psn','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'end_date_time_local','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'deleted','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'constant':false,'inputs':[{'name':'task_uuid','type':'string'},{'name':'input','type':'string'}],'name':'set_end_date_time','outputs':[],'payable':false,'type':'function'},{'constant':false,'inputs':[{'name':'task_uuid','type':'string'},{'name':'input','type':'string'}],'name':'set_start_date_time','outputs':[],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'end_date_time','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'constant':false,'inputs':[{'name':'task_uuid','type':'string'},{'name':'input','type':'string'}],'name':'set_end_date_time_local','outputs':[],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'tenant_id','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'constant':true,'inputs':[],'name':'pid','outputs':[{'name':'','type':'string'}],'payable':false,'type':'function'},{'inputs':[{'name':'task_uuid','type':'string'},{'name':'_pid','type':'string'},{'name':'_psn','type':'string'},{'name':'_tenant_id','type':'string'},{'name':'_start_date_time','type':'string'},{'name':'_end_date_time','type':'string'},{'name':'_start_date_time_local','type':'string'},{'name':'_end_date_time_local','type':'string'}],'payable':false,'type':'constructor'},{'anonymous':false,'inputs':[{'indexed':true,'name':'task_uuid','type':'bytes32'},{'indexed':false,'name':'policy_contract_address','type':'address'}],'name':'event_new_policy','type':'event'},{'anonymous':false,'inputs':[{'indexed':true,'name':'task_uuid','type':'bytes32'},{'indexed':false,'name':'old_val','type':'string'},{'indexed':false,'name':'new_val','type':'string'}],'name':'event_set_start_date_time','type':'event'},{'anonymous':false,'inputs':[{'indexed':true,'name':'task_uuid','type':'bytes32'},{'indexed':false,'name':'old_val','type':'string'},{'indexed':false,'name':'new_val','type':'string'}],'name':'event_set_end_date_time','type':'event'},{'anonymous':false,'inputs':[{'indexed':true,'name':'task_uuid','type':'bytes32'},{'indexed':false,'name':'old_val','type':'string'},{'indexed':false,'name':'new_val','type':'string'}],'name':'event_set_start_date_time_local','type':'event'},{'anonymous':false,'inputs':[{'indexed':true,'name':'task_uuid','type':'bytes32'},{'indexed':false,'name':'old_val','type':'string'},{'indexed':false,'name':'new_val','type':'string'}],'name':'event_set_end_date_time_local','type':'event'},{'anonymous':false,'inputs':[{'indexed':true,'name':'task_uuid','type':'bytes32'},{'indexed':false,'name':'old_val','type':'string'},{'indexed':false,'name':'new_val','type':'string'}],'name':'event_set_status','type':'event'},{'anonymous':false,'inputs':[{'indexed':true,'name':'task_uuid','type':'bytes32'},{'indexed':false,'name':'old_val','type':'string'},{'indexed':false,'name':'new_val','type':'string'}],'name':'event_set_deleted','type':'event'}]";
      _contract_bytecode = "606060405234156200001057600080fd5b60405162001cb538038062001cb58339810160405280805182019190602001805182019190602001805182019190602001805182019190602001805182019190602001805182019190602001805182019190602001805190910190505b60008780516200008292916020019062000262565b5060018680516200009892916020019062000262565b506002858051620000ae92916020019062000262565b506003848051620000c492916020019062000262565b506004838051620000da92916020019062000262565b506005828051620000f092916020019062000262565b5060068180516200010692916020019062000262565b506200011f6401000000006200095e620001cb82021704565b876040518082805190602001908083835b602083106200015257805182525b601f19909201916020918201910162000130565b6001836020036101000a03801982511681845116179092525050509190910192506040915050519081900390207f536004647d57d2f9fffc6c6eb47cd5c07a456689b99ca2b759f12394a11f6a0f30604051600160a060020a03909116815260200160405180910390a25b50505050505050506200030c565b60408051908101604052600981527f6163746976617465640000000000000000000000000000000000000000000000602082015260079080516200021492916020019062000262565b5060408051908101604052600581527f66616c7365000000000000000000000000000000000000000000000000000000602082015260089080516200025e92916020019062000262565b505b565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620002a557805160ff1916838001178555620002d5565b82800160010185558215620002d5579182015b82811115620002d5578251825591602001919060010190620002b8565b5b50620002e4929150620002e8565b5090565b6200030991905b80821115620002e45760008155600101620002ef565b5090565b90565b611999806200031c6000396000f300606060405236156100e35763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416630a2e48f681146100e85780631199fd88146100fd57806314198b1b14610192578063200d2ed21461021d57806328b35e4f146102a857806329c3c295146103335780633266f6ca146103c85780633af8f69b1461045d57806350021af2146104e85780636b35f7c11461057357806388ece7b1146105fe5780638e5cc11e146106935780639c1e066f14610728578063a7ed431f146107b3578063d674161514610848578063f1068454146108d3575b600080fd5b34156100f357600080fd5b6100fb61095e565b005b341561010857600080fd5b6100fb60046024813581810190830135806020601f8201819004810201604051908101604052818152929190602084018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405281815292919060208401838380828437509496506109f195505050505050565b005b341561019d57600080fd5b6101a5610b7e565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561022857600080fd5b6101a5610c1c565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156102b357600080fd5b6101a5610cba565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561033e57600080fd5b6100fb60046024813581810190830135806020601f8201819004810201604051908101604052818152929190602084018383808284378201915050505050509190803590602001908201803590602001908080601f016020809104026020016040519081016040528181529291906020840183838082843750949650610d5895505050505050565b005b34156103d357600080fd5b6100fb60046024813581810190830135806020601f8201819004810201604051908101604052818152929190602084018383808284378201915050505050509190803590602001908201803590602001908080601f016020809104026020016040519081016040528181529291906020840183838082843750949650610ee595505050505050565b005b341561046857600080fd5b6101a5611072565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156104f357600080fd5b6101a5611110565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561057e57600080fd5b6101a56111ae565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561060957600080fd5b6100fb60046024813581810190830135806020601f8201819004810201604051908101604052818152929190602084018383808284378201915050505050509190803590602001908201803590602001908080601f01602080910402602001604051908101604052818152929190602084018383808284375094965061124c95505050505050565b005b341561069e57600080fd5b6100fb60046024813581810190830135806020601f8201819004810201604051908101604052818152929190602084018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405281815292919060208401838380828437509496506113d995505050505050565b005b341561073357600080fd5b6101a5611566565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156107be57600080fd5b6100fb60046024813581810190830135806020601f8201819004810201604051908101604052818152929190602084018383808284378201915050505050509190803590602001908201803590602001908080601f01602080910402602001604051908101604052818152929190602084018383808284375094965061160495505050505050565b005b341561085357600080fd5b6101a5611791565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156108de57600080fd5b6101a561182f565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101e25780820151818401525b6020016101c9565b50505050905090810190601f16801561020f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b60408051908101604052600981527f6163746976617465640000000000000000000000000000000000000000000000602082015260079080516109a59291602001906118cd565b5060408051908101604052600581527f66616c7365000000000000000000000000000000000000000000000000000000602082015260089080516109ed9291602001906118cd565b505b565b816040518082805190602001908083835b60208310610a2257805182525b601f199092019160209182019101610a02565b6001836020036101000a03801982511681845116179092525050509190910192506040915050519081900390207f7869ee11cc6ef6d36afa40dbb9213081f014daa6b79e7af8fd10f0ee632301c7600883604051604080825283546002600019610100600184161502019091160490820181905281906020820190606083019086908015610af15780601f10610ac657610100808354040283529160200191610af1565b820191906000526020600020905b815481529060010190602001808311610ad457829003601f168201915b5050838103825284818151815260200191508051906020019080838360005b83811015610b295780820151818401525b602001610b10565b50505050905090810190601f168015610b565780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a26008818051610b789291602001906118cd565b505b5050565b60058054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b60078054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b60038054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b816040518082805190602001908083835b60208310610d8957805182525b601f199092019160209182019101610d69565b6001836020036101000a03801982511681845116179092525050509190910192506040915050519081900390207f775048f6e5511b48bdba9d7167a14398988fb5f1174516da0fea78bb16a7cc60600783604051604080825283546002600019610100600184161502019091160490820181905281906020820190606083019086908015610e585780601f10610e2d57610100808354040283529160200191610e58565b820191906000526020600020905b815481529060010190602001808311610e3b57829003601f168201915b5050838103825284818151815260200191508051906020019080838360005b83811015610e905780820151818401525b602001610e77565b50505050905090810190601f168015610ebd5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a26007818051610b789291602001906118cd565b505b5050565b816040518082805190602001908083835b60208310610f1657805182525b601f199092019160209182019101610ef6565b6001836020036101000a03801982511681845116179092525050509190910192506040915050519081900390207fb54f212ba75dc7d45d15beed8db225a57535927d75224904de4127853ea36ef4600583604051604080825283546002600019610100600184161502019091160490820181905281906020820190606083019086908015610fe55780601f10610fba57610100808354040283529160200191610fe5565b820191906000526020600020905b815481529060010190602001808311610fc857829003601f168201915b5050838103825284818151815260200191508051906020019080838360005b8381101561101d5780820151818401525b602001611004565b50505050905090810190601f16801561104a5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a26005818051610b789291602001906118cd565b505b5050565b60018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b60068054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b60088054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b816040518082805190602001908083835b6020831061127d57805182525b601f19909201916020918201910161125d565b6001836020036101000a03801982511681845116179092525050509190910192506040915050519081900390207f2fb33a9dbfc9a90951b5e7dec08ebd43484893b4820b0af4805907c93378098060048360405160408082528354600260001961010060018416150201909116049082018190528190602082019060608301908690801561134c5780601f106113215761010080835404028352916020019161134c565b820191906000526020600020905b81548152906001019060200180831161132f57829003601f168201915b5050838103825284818151815260200191508051906020019080838360005b838110156113845780820151818401525b60200161136b565b50505050905090810190601f1680156113b15780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a26004818051610b789291602001906118cd565b505b5050565b816040518082805190602001908083835b6020831061140a57805182525b601f1990920191602091820191016113ea565b6001836020036101000a03801982511681845116179092525050509190910192506040915050519081900390207f0a16ab5cf37fa2a5b28c57bf009795e95053cfd0b1093146a54691c4a0d6ae7e6003836040516040808252835460026000196101006001841615020190911604908201819052819060208201906060830190869080156114d95780601f106114ae576101008083540402835291602001916114d9565b820191906000526020600020905b8154815290600101906020018083116114bc57829003601f168201915b5050838103825284818151815260200191508051906020019080838360005b838110156115115780820151818401525b6020016114f8565b50505050905090810190601f16801561153e5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a26003818051610b789291602001906118cd565b505b5050565b60048054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b816040518082805190602001908083835b6020831061163557805182525b601f199092019160209182019101611615565b6001836020036101000a03801982511681845116179092525050509190910192506040915050519081900390207f73e64057ff2212006e5020dbe82240651058c6797bcbdcec592347b26e17e28f6006836040516040808252835460026000196101006001841615020190911604908201819052819060208201906060830190869080156117045780601f106116d957610100808354040283529160200191611704565b820191906000526020600020905b8154815290600101906020018083116116e757829003601f168201915b5050838103825284818151815260200191508051906020019080838360005b8381101561173c5780820151818401525b602001611723565b50505050905090810190601f1680156117695780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a26006818051610b789291602001906118cd565b505b5050565b60028054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b60008054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c145780601f10610be957610100808354040283529160200191610c14565b820191906000526020600020905b815481529060010190602001808311610bf757829003601f168201915b505050505081565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061190e57805160ff191683800117855561193b565b8280016001018555821561193b579182015b8281111561193b578251825591602001919060010190611920565b5b5061194892915061194c565b5090565b61196a91905b808211156119485760008155600101611952565b5090565b905600a165627a7a723058203b2e20343e99996d0531025acd2743cf40c88f8d1eb6610f13aa2a482de7f9590029";
    }

    //public async Task<string> Create(
    //  string task_uuid,
    //  string pid, string psn,
    //  string tenant_id,
    //  string start_date_time, string end_date_time,
    //  string start_date_time_local, string end_date_time_local)
    //{
    //  Web3Geth web3geth = _web3geth;
    //  string sender_address = _default_sender_address;
    //  string contract_abi = _contract_abi;
    //  string contract_bytecode = _contract_bytecode;
    //}
  }
}
